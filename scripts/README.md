# uGT build scripts


## Example workflow

Example workflow implementing a menu build.

**Note:** this requires a menu distribution generated by `tm-vhdlproducer` as
input (not a bare XML file).

**Note:** take care that your machine is capable of running up to six synthesis
threads at once. This requires at least 128 GiB RAM and a decent Intel i7/xeon  
CPU with at least +3.0 GHz and 16/32 cores.

    $ python makeProject.py --user doe --tag mp7fw_v2_4_1 --menu /path/to/L1Menu_Sample --build 0x1042 --path /tmp/fwdir

    $ python startSynth.py 2017.4 /tmp/fwdir/mp7_ugt/0x1042/mp7fw_v2_4_1/build/build_0x1042.cfg

    $ python checkSynth.py /tmp/fwdir/mp7_ugt/0x1042/mp7fw_v2_4_1/build/build_0x1042.cfg

    $ python fwpacker.py /tmp/fwdir/mp7_ugt/0x1042/mp7fw_v2_4_1/build/build_0x1042.cfg --outdir /tmp


## Scripts


### makeProject.py

Create a new build area to synthesize a uGT menu.

    $ python makeProject.py -u <username> -t <mp7tag> -m <menu-dir> -b <build-id>


### startSynth.py

Starts synthesis of all modules in parallel.

**Note:** take care that your machine is capable of running up to six synthesis
threads at once. This requires at least 128 GiB RAM and a decent Intel i7/xeon
CPU with at least +3.0 GHz and 16/32 cores.

    $ startSynth.py <vivado-version> <build-config-file>


### checkSynth.py

Check finished synthesis for errors and timing constraints.

    $ checkSynth.py <build-config-file>


### fwpacker.py

Creating firmware tarball containing all module bit files and additional build information.

    $ python fwpacker.py <build-config-file>


### pkgpatch.py

Patches HDL top package of uGT firmware, setting timestamp, username and
hostname. This script is invoked by `makeProject.py`.

    $ python pkgpatch.py <src-top> <dest-top> -b <build-id>


### mp7patch.py

Patches MP7 firmware tag fetched by `ProjectManager.py` and frees unused link
areaes and other adaptions to the default MP7 firemware (like adding TTC port).
This script is invoked by `makeProject.py`.

    $ python mp7patch.py <path/to/mp7fw_vx_y_z>


### toolbox.py

Common functions unsed by the build sripts.
